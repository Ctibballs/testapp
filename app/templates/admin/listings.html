{% extends 'base.html' %}
{% block title %}Manage Listings{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h3">Manage Listings</h1>
  <div>
    <a class="btn btn-secondary" href="{{ url_for('upload_listings') }}">Upload Spreadsheet</a>
    <a class="btn btn-primary" href="{{ url_for('admin_dashboard') }}">Back to Dashboard</a>
  </div>
</div>
{% if listings %}
  <div class="table-responsive">
    <table class="table table-striped align-middle">
      <thead>
        <tr>
          <th>Address</th>
          <th>Suburb</th>
          <th>Date</th>
          <th>Agent</th>
          <th>Needs Help</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for listing in listings %}
          <tr>
            <td>{{ listing.address }}</td>
            <td>{{ listing.suburb or '-' }}</td>
            <td>{% if listing.date %}{{ listing.date.strftime('%d %b %Y') }}{% else %}-{% endif %}</td>
            <td>
              {% if listing.agent %}
                {{ listing.agent.name }}
              {% elif listing.agent_initials %}
                {{ listing.agent_initials }}
              {% else %}
                -
              {% endif %}
            </td>
            <td>{% if listing.needs_help %}<span class="badge text-bg-warning text-dark">Yes</span>{% else %}<span class="badge text-bg-secondary">No</span>{% endif %}</td>
            <td><a class="btn btn-sm btn-outline-primary" href="{{ url_for('edit_listing', listing_id=listing.id) }}">Edit</a></td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% else %}
  <div class="alert alert-info">No listings have been uploaded yet.</div>
{% endif %}
{% endblock %}
